{%extends 'base.html'%}
{% load bootstrap4 %}
{% load static %}
{% block content %}
<div class="main row">
  <div class="col-xs-12 col-md-1"></div>
  <div class="col-xs-12 col-md-6">
    {% if timeline_images %}
    {% for image in timeline_images %}
    <div class="card" style="margin-bottom: 5rem;">
      <div class="card-header d-flex">
        <div class="profile-image">
          <a href="/profile/{{image.profile.id}}">
            <img class="rounded-circle" style="width: 3em;height: 3em;" src="{{image.profile.profile_image.url}}"
              alt="user">
          </a>
        </div>
        <div class="profile" style="margin-left: 1em;">
          <a href="/profile/{{image.profile.id}}" class="profile_tag" style="color: black;">{{image.profile}}</a>
          <p><strong><i>#{{image.name}}</i></strong></p>
        </div>
      </div>
      <img src="{{image.image.url}}" class="card-img-top" alt="upload" style="height: 40rem;object-fit: cover;">
      <div class="card-body">
        <form action="{% url 'LikePost' image_id=image.id %}">
          {% csrf_token %}
          <button type="submit" name="image_id" value={{image.id}}
            style="border: 0px; background-color: transparent; margin-bottom: 1rem;"><i
              class="far fa-heart"></i></button>
        </form>
        <div class="liked-count">{{image.likes.count}} likes</div>
        <div class="post">
          <a href="#" class="likes"><strong>{{image.profile}}</strong></a>
          <span class="post-link">{{image.caption}}</span>
          <div class="text-muted" style="font-size: 1.4rem;margin-top: 1%;">{{count}} comments</div>
          {% for comment in comments %}
          {% if comment.image.id == image.id %}
          <div>
            <a href="#" class="likes"><em style="font-size: 1.2rem;">{{comment.user}}</em></a>
            <span class="post-link"><em style="font-size: 1.2rem;">{{comment.content}}</em></span>
          </div>
          {% endif %}
          {% endfor %}
          <div class="text-muted">{{image.pub_date | timesince }} ago</div>
        </div>
      </div>
      <div class="card-footer" style="padding: 0;">
        <form role="add_comment" , action="{% url 'AddComment' image_id=image.id %}">
          {% csrf_token%}
          <div class="input-group">
            <input type="text" class="form-control" placeholder="comment" name="comments"
              style="font-size: 1.2rem; border: 0;">
            <div class="input-group-btn">
              <button class="btn" type="submit" style="font-size: 1.2rem;"> Post</button>
            </div>
          </div>
        </form>
      </div>
    </div>
    {% endfor %}
    {% else %}
    <div class="nothing text-center">
      <h2>Nothing to see</h2>
      <h2>Get started on Instagram by following an Instagram user or share an image to see images on the timeline.
      </h2>
    </div>
    {% endif %}
  </div>
  <div class="col-xs-12 col-md-1"></div>
  <div class="col-xs-12 col-md-3">
    <div class="card">
      <div class="card-header" style="font-size: 1.2rem;">
        <h5><strong>Follow Suggestions</strong></h5>
      </div>
      <ul class="list-group list-group-flush">
        {% for prof in follow_suggestions %}
        {% if prof == profile%}
        {% elif prof != profile %}
        <li class="list-group-item d-flex">
          <div class="profile-image">
            <a href="/profile/{{prof.id}}"><img src="{{prof.profile_image.url}}" alt="avatar" class="rounded-circle"
                style="height: 3em;width: 3em;"></a>
          </div>
          <div class="profile">
            <a href="/profile/{{prof.id}}" class="profile_tag">{{prof.user.username}}</a>
          </div>
        </li>
        {% endif %}
        {% endfor %}
      </ul>
    </div>
  </div>
  <div class="col-xs-12 col-md-1"></div>
</div>
{% endblock %}